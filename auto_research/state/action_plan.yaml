created_at: '2026-01-26T22:30:00+08:00'
execution_order:
  phase_0_motivation:
    description: Motivation 强化（最高优先级，解决技术质量瓶颈）
    parallel: false
    rationale: 'Technical Quality 权重 40%，是分数瓶颈。

      **关键发现**: PaLU 使用 block_size=32 强制对齐，RAP SVD 不强制！

      - PaLU: third_party/palu/palu/rank_search.py:11-17

      - RAP SVD: third_party/RAP/prune.py:775, round(head_dim * retain_ratio)

      需要多个压缩方法的证据支撑 Motivation。

      '
    tasks:
    - 'C0_SURVEY: 调研更多压缩方法的对齐策略'
    - 'C5_RAP_SVD: 使用 RAP SVD 生成不对齐模型并验证 repair'
  phase_1_figures:
    description: 图表修复（高优先级，Reviewer Must Fix）
    parallel: true
    tasks:
    - 'FIG_M3: Figure 5 标签重叠'
    - 'FIG_M1: Figure 3 legend 重叠'
    - 'FIG_M2: Figure 4 视觉区分'
    - 'FIG_M4: Figure 6 Y 轴'
  phase_2_font:
    description: 统一字体大小
    parallel: false
    tasks:
    - 'FIG_FONT: 所有图字体 >= 9pt'
  phase_3_text:
    description: 少量文字修改
    parallel: true
    tasks:
    - 'M1: Abstract scope'
    - 'M2_CONCLUSION: Conclusion fix'
    - 'm2_table: Table 1 N/A'
experiment_tasks:
- actions:
  - agent: researcher
    expected_output: 5-10 个方法的名称和论文链接
    step: 1
    task: WebSearch 搜索 2024-2025 LLM 低秩压缩方法
  - agent: researcher
    expected_output: 方法对比表格，包含对齐策略列
    step: 2
    task: 分析每个方法的维度处理策略（从论文或开源代码）
  - agent: writer
    expected_output: 更新的 Latex/main.tex
    step: 3
    task: 更新论文 Related Work 和 Motivation
  description: 调研更多 LLM 压缩方法，分析其对齐策略
  id: C0_SURVEY
  priority: critical
  rationale: '论文 Motivation 需要多个压缩方法的证据支撑。

    需要调研：ASVD, SliceGPT, LLM-Pruner, LoRA 等方法的对齐策略。

    '
  status: pending
  type: RESEARCH_REQUIRED
- actions:
  - agent: experimenter
    expected_output: results/RAP_SVD/llama_svd_0.8.pt
    gpu_constraint: gpu_a100_80gb
    slurm_required: true
    step: 1
    task: python third_party/RAP/prune.py --attention svd --model llama --retain-ratio
      0.8
  - agent: experimenter
    expected_output: 维度分布报告
    step: 2
    task: 验证维度分布，确认 ~97% 不对齐
  - agent: experimenter
    expected_output: speedup 数据，预期 +25-30%
    step: 3
    task: 运行 dimension repair 并 benchmark SDPA latency
  - agent: experimenter
    expected_output: 新的 fig6_e2e.pdf
    step: 4
    task: 更新 Figure 6 展示 repair 效果
  description: 使用 RAP SVD 生成不对齐模型并验证 dimension repair
  id: C5_RAP_SVD
  priority: critical
  rationale: 'RAP SVD 使用 round(head_dim * retain_ratio)，不强制对齐！

    retain_ratio=0.8, head_dim=128 → rank=102（不是 8 的倍数）

    '
  status: pending
  type: EXPERIMENT_REQUIRED
- description: 重新生成 Figure 5 解决标签重叠
  id: FIG_M3
  modifications:
  - 使用 adjustText 或 annotate with arrows
  - 缩小 X 轴范围
  - 增大字体
  output: Latex/figures/fig5_repair_tradeoff.pdf
  script: scripts/plot_results.py
- description: 重新生成 Figure 3 移动 legend
  id: FIG_M1
  modifications:
  - legend 移到 lower left 或图外
  output: Latex/figures/fig2_sdpa_latency.pdf
  script: scripts/plot_results.py
- description: 重新生成 Figure 4 区分 Not Confirmed
  id: FIG_M2
  modifications:
  - L2 Cache 条形改灰色或加 hatching
  output: Latex/figures/fig4_root_cause.pdf
  script: scripts/plot_results.py
- description: 重新生成 Figure 6 用 subplots
  id: FIG_M4
  modifications:
  - '分成两个 subplot: Prefill / Decode'
  output: Latex/figures/fig6_e2e.pdf
  script: scripts/plot_llm_results.py
issues:
- actions:
  - agent: experimenter
    expected_output: 新的 Latex/figures/fig5_repair_tradeoff.pdf，无标签重叠
    status: pending
    step: 1
    task: "修改 scripts/plot_results.py 中生成 Figure 5 的代码：\n\n1. 使用 adjustText 库自动调整标签位置避免重叠\n\
      \   pip install adjustText\n   from adjustText import adjust_text\n\n2. 或者使用\
      \ matplotlib 的 annotate 带 arrowprops 参数\n   添加 leader lines 从标签指向数据点\n\n3. 缩小\
      \ X 轴范围从 0-20% 到 0-12%（数据点都在此范围内）\n\n4. 增加字体大小到 10pt\n\n重新运行绘图脚本生成新的 fig5_repair_tradeoff.pdf\n"
  depends_on: []
  description: '**Reviewer 原文**:

    "Figure 5 (Page 4): Data point labels (d=107, d=121, d=125) overlap significantly

    in upper-left cluster, making values hard to read. Use leader lines or companion
    table."


    这是 reviewer "Must fix" 列表的第一项！


    需要重新生成 fig5_repair_tradeoff.pdf 并修复标签重叠。

    '
  id: FIG_M3
  inner_loop_count: 1
  max_inner_loops: 2
  priority: high
  status: completed
  title: Fix Figure 5 Label Overlap (CRITICAL)
  type: EXPERIMENT_REQUIRED
- actions:
  - agent: experimenter
    expected_output: 新的 Latex/figures/fig2_sdpa_latency.pdf，legend 不与数据重叠
    status: pending
    step: 1
    task: "修改 scripts/plot_results.py 中生成 SDPA latency 图的代码：\n\n1. 将 legend 移动到 'lower\
      \ left' 或使用 bbox_to_anchor 放到图外\n   plt.legend(loc='lower left')\n   或\n   plt.legend(bbox_to_anchor=(1.05,\
      \ 1), loc='upper left')\n\n2. 增加字体大小到 10pt\n\n重新运行绘图脚本生成新的 fig2_sdpa_latency.pdf\n"
  depends_on: []
  description: '**Reviewer 原文**:

    "Figure 3 (Page 3): Legend box overlaps with data points in upper-right region.

    Move to lower-left or outside plot."


    需要重新生成 fig2_sdpa_latency.pdf（文件名虽然是 fig2，但在论文中是 Figure 3）

    '
  id: FIG_M1
  inner_loop_count: 1
  max_inner_loops: 2
  priority: high
  status: completed
  title: Fix Figure 3 Legend Overlap
  type: EXPERIMENT_REQUIRED
- actions:
  - agent: experimenter
    expected_output: 新的 Latex/figures/fig4_root_cause.pdf，Not Confirmed 有视觉区分
    status: pending
    step: 1
    task: "修改 scripts/plot_results.py 中生成 root cause 图的代码：\n\n1. 将 \"L2 Cache Sector\"\
      \ (Not Confirmed) 的条形图改为灰色\n   colors = ['#2196F3', '#808080', '#2196F3', '#2196F3']\
      \  # 第2个灰色\n\n2. 或添加 hatching 图案\n   bars[1].set_hatch('///')\n\n3. 在图例中添加说明区分\
      \ \"Confirmed\" vs \"Not Confirmed\"\n\n重新运行绘图脚本生成新的 fig4_root_cause.pdf\n"
  depends_on: []
  description: '**Reviewer 原文**:

    "Figure 4 (Page 3): ''L2 Cache Sector'' bar for ''Not Confirmed'' hypothesis should
    be

    visually distinct - use grey color or hatching pattern."


    需要重新生成 fig4_root_cause.pdf

    '
  id: FIG_M2
  inner_loop_count: 0
  max_inner_loops: 2
  priority: high
  status: in_progress
  title: Fix Figure 4 Visual Distinction
  type: EXPERIMENT_REQUIRED
- actions:
  - agent: experimenter
    expected_output: 新的 Latex/figures/fig6_e2e.pdf，两个 subplot 显示清晰
    status: pending
    step: 1
    task: '修改 scripts/plot_llm_results.py 中生成 E2E 图的代码：


      选择方案 (b) 使用 subplots:


      fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(10, 4))


      ax1: Prefill throughput (线性 Y 轴，8000-10500 范围)

      ax2: Decode throughput (线性 Y 轴，0-1500 范围)


      这样两个对比都清晰可见。


      重新运行绘图脚本生成新的 fig6_e2e.pdf

      '
  depends_on: []
  description: '**Reviewer 原文**:

    "Figure 6 (Page 5): Y-axis scale makes Prefill comparison (9870 vs 9672, -2%)

    appear identical while Decode (119 vs 1371, +11.5x) dominates.

    Consider: (a) use broken axis, (b) separate subplots for Prefill/Decode,

    or (c) log scale."


    需要重新生成 fig6_e2e.pdf

    '
  failure_reason: Exceeded max loops 2
  id: FIG_M4
  inner_loop_count: 2
  max_inner_loops: 2
  priority: medium
  status: failed
  title: Fix Figure 6 Y-axis Scale
  type: EXPERIMENT_REQUIRED
- actions:
  - agent: experimenter
    expected_output: 所有 figures 字体 >= 9pt
    status: pending
    step: 1
    task: "在所有绘图脚本开头设置全局字体大小：\n\nimport matplotlib.pyplot as plt\nplt.rcParams.update({\n\
      \    'font.size': 10,\n    'axes.labelsize': 10,\n    'axes.titlesize': 11,\n\
      \    'xtick.labelsize': 9,\n    'ytick.labelsize': 9,\n    'legend.fontsize':\
      \ 9,\n})\n\n重新生成所有 6 个 figures\n"
  depends_on:
  - FIG_M3
  - FIG_M1
  - FIG_M2
  - FIG_M4
  description: '**Reviewer 原文**:

    "Figures 2-5 axis labels are approximately 7-8pt. Increase to 9pt minimum

    for print readability."


    这影响 Paper Presentation (30% 权重)

    '
  failure_reason: Exceeded max loops 1
  id: FIG_FONT
  inner_loop_count: 1
  max_inner_loops: 1
  priority: medium
  status: failed
  title: Increase Font Sizes in All Figures
  type: EXPERIMENT_REQUIRED
- actions:
  - agent: writer
    expected_output: Abstract 有 scope 限定
    status: pending
    step: 1
    task: '小幅调整：在 Abstract 第一句后加入 scope 限定


      当前 (line 74):

      "Post-training compression can produce irregular tensor dimensions..."


      改为:

      "Post-training compression \emph{without alignment constraints} can produce..."


      仅此一处修改，不做大改。

      '
  depends_on:
  - FIG_M3
  - FIG_M1
  - FIG_M2
  - FIG_M4
  description: '论文已在 line 106-110 有完整的 "Scope Clarification" 段落。

    Reviewer 说 "excellent and honest" 但想更 prominent。


    **注意**: 这个问题之前 12 轮都在处理，没有突破。

    本轮降低优先级，聚焦图表修复。

    '
  id: M1
  inner_loop_count: 0
  max_inner_loops: 1
  priority: low
  status: pending
  title: 96.9% Scope Clarification (Already Addressed)
  type: WRITING_ONLY
- actions:
  - agent: writer
    expected_output: Conclusion 与论文其他部分一致
    status: pending
    step: 1
    task: '修改 Conclusion (line 487):


      从:

      "End-to-end evaluation shows PaLU achieves 11.5× decode speedup despite misalignment."


      改为:

      "End-to-end evaluation shows PaLU achieves 11.5× decode speedup

      from KV cache compression (orthogonal to alignment)."


      这与论文其他部分 (Table 6, Figure 6 caption) 一致。

      '
  depends_on: []
  description: '**Reviewer 原文 (m5)**:

    "Conclusion line 487: ''End-to-end evaluation shows PaLU achieves 11.5x decode

    speedup despite misalignment'' - but PaLU checkpoints are aligned"


    需要修正这个不一致。

    '
  id: M2_CONCLUSION
  inner_loop_count: 0
  max_inner_loops: 1
  priority: medium
  status: pending
  title: Fix Conclusion Line 487
  type: WRITING_ONLY
- actions:
  - agent: writer
    expected_output: Table 1 使用 N/A 并有解释
    status: pending
    step: 1
    task: '修改 Table 1 (line 219):


      从: "\\multicolumn{1}{c}{---}"

      改为: "\\multicolumn{1}{c}{N/A$^\\dagger$}"


      在表格下方添加 footnote:

      "$\\dagger$ MEM\\_EFFICIENT requires strict 8-alignment; unavailable for $d$=107."

      '
  depends_on: []
  description: '**Reviewer (m2)**:

    "Table 1: Change ''---'' to ''N/A'' with explanatory footnote"


    小改动

    '
  id: m2_table
  inner_loop_count: 0
  max_inner_loops: 1
  priority: low
  status: pending
  title: Table 1 N/A Notation
  type: WRITING_ONLY
notes:
- 策略转变：从文字修改转向图表修复
- Reviewer 'Must Fix' 有 5 项图表问题，之前 12 轮忽略了！
- 图表修复需要 Python 脚本，标记为 EXPERIMENT_REQUIRED
- 文字修改降低优先级（已尝试 12 轮无效）
- 假设：聚焦 Presentation 维度可能突破停滞
- 风险：绘图脚本可能需要修改，需要理解现有代码结构
planner_summary: '**严重停滞警告**: 连续 25+ 次迭代无有效进步！


  **策略诊断**:

  之前 12 轮都在做「文字修改」，但 reviewer 的 "Must Fix" 列表中有 5 个是**图表问题**！


  Review 原文 "Must fix (minimum 3)" 包括：

  1. Figure 5 data labels overlap (MAJOR)

  2. Figure 3 legend overlaps data points

  3. Figure 4 styling (non-confirmed bar needs visual distinction)

  4. Figure 6 Y-axis scale

  5. Font sizes


  **本轮策略转变**:

  - 停止文字微调（已无效）

  - **聚焦图表修复**：这是 reviewer 明确标记为 "Must Fix" 的 items

  - 使用 matplotlib/Python 重新生成修复后的图表


  **分类结果**:

  - M3 (Figure 5): EXPERIMENT_REQUIRED (需要重新生成图表)

  - 其他 Figure issues: EXPERIMENT_REQUIRED (需要重新生成图表)

  - M1, M2: WRITING_ONLY (但不再优先)


  **核心假设**:

  Reviewer 给 "Presentation" 30% 权重，图表问题直接影响这个维度。

  之前专注 Technical Quality (40%) 的文字修改，忽略了 Presentation 的视觉问题。

  '
review_iteration: 13
review_score: 7.2
stagnation_analysis:
  iterations_without_progress: 25
  new_approach: '聚焦图表修复：

    1. Figure 5 标签重叠 → 使用 adjustText 或 leader lines

    2. Figure 3 legend → 移到 lower left

    3. Figure 4 styling → 灰色或 hatching for Not Confirmed

    4. Figure 6 Y-axis → 分成两个 subplot

    5. 所有图字体 → 10pt

    '
  previous_approaches:
  - 添加 footnote 澄清 96.9%
  - 添加 Scope Clarification 段落
  - 修改 Section 6.4 标题
  - 修改 Abstract 措辞
  - 减少 'future work' 出现次数
  why_failed: '所有之前的修改都是「文字层面」的改变，

    但 Reviewer 明确列出了 5 个「图表层面」的 Must Fix 问题。

    Presentation 权重 30%，图表质量是其关键组成部分。

    '
success_criteria:
  expected_score_improvement:
    current: 7.2
    rationale: 'Presentation 权重 30%，Technical Quality 权重 40%。

      之前只改文字影响 TQ，本轮改图表直接影响 Presentation。

      预计 Presentation 从 7/10 提升到 8/10 = +0.3 weighted score。

      '
    with_all_fixes: 8.0
    with_figure_fixes: 7.8
  must_complete:
  - 'FIG_M3: Figure 5 标签不重叠'
  - 'FIG_M1: Figure 3 legend 不遮挡数据'
  - 'FIG_M2: Figure 4 Not Confirmed 有视觉区分'
  - 'M2_CONCLUSION: Conclusion 一致性'
  nice_to_have:
  - 'm2_table: Table 1 N/A'
  should_complete:
  - 'FIG_M4: Figure 6 两个 subplot'
  - 'FIG_FONT: 所有图字体 >= 9pt'
  - 'M1: Abstract scope'
target_score: 8.0
writing_tasks:
- changes_required:
  - change: 添加 'without alignment constraints'
    section: Abstract (line 74)
  description: Abstract scope 限定
  id: M1
  target_files:
  - Latex/main.tex
- changes_required:
  - change: '''despite misalignment'' → ''from KV cache compression (orthogonal to
      alignment)'''
    section: Conclusion (line 487)
  description: 修正 Conclusion
  id: M2_CONCLUSION
  target_files:
  - Latex/main.tex
- changes_required:
  - change: '''---'' → ''N/A'' with footnote'
    section: Table 1 (line 219)
  description: Table 1 N/A notation
  id: m2_table
  target_files:
  - Latex/main.tex
